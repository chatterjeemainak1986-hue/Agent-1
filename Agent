import React, { useState } from "react";

// Agent Capstone Presentation Component
// Single-file React component (Tailwind CSS assumed available)
// Default export — paste into a React app (Vite/Next/CRA) and render <AgentCapstone />

export default function AgentCapstone() {
  const [problem, setProblem] = useState(
    "I am Trying to make people use ai correctly an rightfully."
  );
  const [whyAgents, setWhyAgents] = useState(
    "Many people nowadays use agents for in appropriate measures."
  );
  const [architecture, setArchitecture] = useState(
    "High-level architecture: agent(s), environment, orchestrator, data store, UI" 
  );
  const [demoNotes, setDemoNotes] = useState(
    "."
  );
  const [theBuild, setTheBuild] = useState(
    "Tools and technologies used (languages, frameworks, agent framework, infra)."
  );
  const [moreTime, setMoreTime] = useState(
    "Planned improvements if more time was available (scaling, evaluation, UX)."
  );

  const [running, setRunning] = useState(false);
  const [demoOutput, setDemoOutput] = useState([]);

  // Fake demo run simulating agent steps
  const runDemo = () => {
    setRunning(true);
    setDemoOutput([]);

    const steps = [
      "Receive input: user uploads dataset and problem description.",
      "Preprocess: clean and vectorize data; identify task type.",
      "Plan: choose a 3-step plan (analyze -> propose model -> evaluate).",
      "Act: train a lightweight model (mock) and produce an evaluation summary.",
      "Report: generate a concise recommendation and confidence score."
    ];

    // simulate step-by-step output
    let i = 0;
    const tick = () => {
      if (i < steps.length) {
        setDemoOutput((s) => [...s, steps[i]]);
        i += 1;
        setTimeout(tick, 650);
      } else {
        setDemoOutput((s) => [...s, "Demo finished — agent produced a recommended action."]);
        setRunning(false);
      }
    };
    tick();
  };

  // simple markdown generator for download
  const downloadMarkdown = () => {
    const md = `# Agent Capstone Project\n\n` +
      `## Problem Statement\n${problem}\n\n` +
      `## Why agents?\n${whyAgents}\n\n` +
      `## What I created (Architecture)\n${architecture}\n\n` +
      `## Demo (notes)\n${demoNotes}\n\n` +
      `## The Build\n${theBuild}\n\n` +
      `## If I had more time\n${moreTime}\n`;

    const blob = new Blob([md], { type: "text/markdown" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "agent-capstone.md";
    a.click();
    URL.revokeObjectURL(url);
  };

  return (
    <div className="max-w-5xl mx-auto p-6 bg-white rounded-2xl shadow-lg">
      <header className="flex items-center justify-between mb-6">
        <h1 className="text-2xl font-semibold">Agent Capstone — Presentation Builder</h1>
        <div className="flex gap-2">
          <button
            onClick={downloadMarkdown}
            className="px-3 py-1 rounded-md border text-sm hover:bg-gray-50"
          >
            Download MD
          </button>
          <button
            onClick={runDemo}
            disabled={running}
            className={`px-3 py-1 rounded-md text-sm border ${running ? "opacity-60 cursor-not-allowed" : "hover:bg-gray-50"}`}
          >
            {running ? "Running demo..." : "Run Demo"}
          </button>
        </div>
      </header>

      <main className="grid grid-cols-1 md:grid-cols-2 gap-6">
        <section className="space-y-4">
          <label className="block text-sm font-medium">Problem Statement</label>
          <textarea value={problem} onChange={(e)=>setProblem(e.target.value)} className="w-full h-28 p-3 border rounded-md" />

          <label className="block text-sm font-medium">Why agents?</label>
          <textarea value={whyAgents} onChange={(e)=>setWhyAgents(e.target.value)} className="w-full h-24 p-3 border rounded-md" />

          <label className="block text-sm font-medium">What you created — Architecture</label>
          <textarea value={architecture} onChange={(e)=>setArchitecture(e.target.value)} className="w-full h-24 p-3 border rounded-md" />

          <label className="block text-sm font-medium">Demo — show your solution (notes)</label>
          <textarea value={demoNotes} onChange={(e)=>setDemoNotes(e.target.value)} className="w-full h-20 p-3 border rounded-md" />

          <label className="block text-sm font-medium">The Build — technologies used</label>
          <textarea value={theBuild} onChange={(e)=>setTheBuild(e.target.value)} className="w-full h-20 p-3 border rounded-md" />

          <label className="block text-sm font-medium">If I had more time — future work</label>
          <textarea value={moreTime} onChange={(e)=>setMoreTime(e.target.value)} className="w-full h-20 p-3 border rounded-md" />
        </section>

        <aside className="p-4 border rounded-md bg-gray-50 flex flex-col gap-4">
          <div>
            <h2 className="font-medium">Live Preview</h2>
            <div className="mt-2 bg-white p-3 rounded-md shadow-sm">
              <h3 className="text-lg font-semibold">Problem Statement</h3>
              <p className
